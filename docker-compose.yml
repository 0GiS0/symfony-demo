version: '3.7'

services:
  nginx:
    build:
      args:
        VERSION: $NGINX_VERSION
      context: .
      dockerfile: ./docker/nginx/Dockerfile
      target: dev
    volumes:
      - ./web:/app/web
    depends_on:
      - php-fpm
    ports:
      - 8000:80
  php-fpm:
    build:
      args:
        VERSION: $PHP_VERSION
      context: .
      dockerfile: ./docker/php-fpm/Dockerfile
      target: dev
    volumes:
      - .:/app
    command: sh -c 'composer install --ignore-platform-reqs && php-fpm'
